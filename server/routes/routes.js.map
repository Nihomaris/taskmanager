{"version":3,"sources":["../../src/routes/routes.js"],"names":["Router","app","use","json","urlencoded","extended","get","req","res","sendFile","__dirname","find","err","data","then","catch","send","post","user","name","body","login","password","pass","email","specialist","proff","save","task","title","description","descr","attached","status","watchers","commentsId","module","exports"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,SAAS,SAATA,MAAS,CAASC,GAAT,EAAc;;AAE5BA,KAAIC,GAAJ,CAAS,qBAAWC,IAAX,EAAT,EAF4B,CAEQ;AACpCF,KAAIC,GAAJ,CAAQ,qBAAWE,UAAX,CAAsB,EAAM;AAClCC,YAAU;AADkB,EAAtB,CAAR;;AAIAJ,KAAIK,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIC,QAAJ,CAAaC,YAAY,mBAAzB;AACA,EAFD;;AAIAT,KAAIK,GAAJ,CAAQ,YAAR,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACnC,iBAAKG,IAAL,CAAU,UAACC,GAAD,EAAMC,IAAN,EAAe;AACxB,OAAGD,GAAH,EAAQ,MAAMA,GAAN;AACR,UAAOC,IAAP;AACA,GAHD,EAICC,IAJD,CAIM,UAACD,IAAD,EAAU;AAACL,OAAIL,IAAJ,CAASU,IAAT;AAAgB,GAJjC,EAKCE,KALD,CAKO,UAACH,GAAD,EAAS;AAACJ,OAAIQ,IAAJ,CAAS,qBAAT;AAAgC,GALjD;AAMA,EAPD;;AASAf,KAAIgB,IAAJ,CAAS,MAAT,EAAiB,UAACV,GAAD,EAAMC,GAAN,EAAc;;AAE9B,MAAIU,OAAO,mBAAS;AACnBC,SAAMZ,IAAIa,IAAJ,CAASD,IADI;AAEnBE,UAAOd,IAAIa,IAAJ,CAASC,KAFG;AAGnBC,aAAUf,IAAIa,IAAJ,CAASG,IAHA;AAInBC,UAAOjB,IAAIa,IAAJ,CAASI,KAJG;AAKnBC,eAAYlB,IAAIa,IAAJ,CAASM;AALF,GAAT,CAAX;;AAQAR,OAAKS,IAAL,GAAYb,IAAZ,CAAiBN,IAAIQ,IAAJ,CAAS,qBAAT,CAAjB,EACCD,KADD,CACO,UAACH,GAAD,EAAS;AAAE,OAAGA,GAAH,EAAQ,MAAMA,GAAN;AAAY,GADtC;AAEA,EAZD;;AAcAX,KAAIgB,IAAJ,CAAS,MAAT,EAAiB,UAACV,GAAD,EAAMC,GAAN,EAAc;AAC9B,iBAAKG,IAAL,CAAU,EAAC,SAASJ,IAAIa,IAAJ,CAASC,KAAnB,EAA0B,YAAYd,IAAIa,IAAJ,CAASG,IAA/C,EAAV,EACA,UAACX,GAAD,EAAMC,IAAN,EAAe;AACd,OAAGD,GAAH,EAAQ,MAAMA,GAAN;AACR,UAAOC,IAAP;AACA,GAJD,EAKCC,IALD,CAKM,UAACD,IAAD,EAAU;AAACL,OAAIL,IAAJ,CAASU,IAAT;AAAgB,GALjC,EAMCE,KAND,CAMO,UAACH,GAAD,EAAS;AAACJ,OAAIQ,IAAJ,CAAS,qBAAT;AAAgC,GANjD;AAQA,EATD;;AAWAf,KAAIgB,IAAJ,CAAS,SAAT,EAAoB,UAACV,GAAD,EAAMC,GAAN,EAAc;AACjC,MAAIoB,OAAO,mBAAS;AACnBC,UAAOtB,IAAIa,IAAJ,CAASS,KADG;AAEnBC,gBAAavB,IAAIa,IAAJ,CAASW,KAFH;AAGnBC,aAAUzB,IAAIa,IAAJ,CAASY,QAHA;AAInBC,WAAQ,MAJW;AAKnBC,aAAU3B,IAAIa,IAAJ,CAASY,QALA;AAMnBG,eAAY;AANO,GAAT,CAAX;;AASAP,OAAKD,IAAL,GACCb,IADD,CACMN,IAAIQ,IAAJ,CAAS,gBAAT,CADN,EAECD,KAFD,CAEO,UAACH,GAAD,EAAS;AAAC,OAAGA,GAAH,EAAQ,MAAMA,GAAN;AAAW,GAFpC;AAGA,EAbD;AAeA,CA5DD;;AA+DAwB,OAAOC,OAAP,GAAiBrC,MAAjB","file":"routes.js","sourcesContent":["import User from '../models/user';\r\nimport Task from '../models/task';\r\nimport bodyParser from 'body-parser';\r\n\r\nconst Router = function(app) {\r\n\r\n\tapp.use( bodyParser.json() );       // to support JSON-encoded bodies\r\n\tapp.use(bodyParser.urlencoded({     // to support URL-encoded bodies\r\n\t  extended: true\r\n\t})); \r\n\r\n\tapp.get('/', (req, res) => {\r\n\t\tres.sendFile(__dirname + 'public/index.html');\r\n\t});\r\n\r\n\tapp.get('/task-list', (req, res) => {\r\n\t\tTask.find((err, data) => {\r\n\t\t\tif(err) throw err;\r\n\t\t\treturn data;\r\n\t\t})\r\n\t\t.then((data) => {res.json(data);})\r\n\t\t.catch((err) => {res.send('Ошибка запроса к БД')})\r\n\t});\r\n\r\n\tapp.post('/reg', (req, res) => {\r\n\r\n\t\tvar user = new User({\r\n\t\t\tname: req.body.name,\r\n\t\t\tlogin: req.body.login,\r\n\t\t\tpassword: req.body.pass,\r\n\t\t\temail: req.body.email,\r\n\t\t\tspecialist: req.body.proff\r\n\t\t});\r\n\r\n\t\tuser.save().then(res.send('Регистрация успешна'))\r\n\t\t.catch((err) => { if(err) throw err; })\r\n\t});\r\n\r\n\tapp.post('/log', (req, res) => {\r\n\t\tUser.find({'login': req.body.login, 'password': req.body.pass}, \r\n\t\t(err, data) => {\r\n\t\t\tif(err) throw err;\r\n\t\t\treturn data;\r\n\t\t})\r\n\t\t.then((data) => {res.json(data);})\r\n\t\t.catch((err) => {res.send('Ошибка запроса к БД')})\r\n\r\n\t});\r\n\r\n\tapp.post('/create', (req, res) => {\r\n\t\tvar task = new Task({\r\n\t\t\ttitle: req.body.title,\r\n\t\t\tdescription: req.body.descr,\r\n\t\t\tattached: req.body.attached,\r\n\t\t\tstatus: 'open',\r\n\t\t\twatchers: req.body.attached,\r\n\t\t\tcommentsId: ''\r\n\t\t})\r\n\r\n\t\ttask.save()\r\n\t\t.then(res.send('Задача создана'))\r\n\t\t.catch((err) => {if(err) throw err;})\r\n\t})\r\n\r\n}\r\n\r\n\r\nmodule.exports = Router;\r\n"]}